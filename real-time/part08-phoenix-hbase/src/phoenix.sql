select 1+1;

drop table student;
create table student(name varchar primary key ,age integer) SALT_BUCKETS = 3;
upsert into student values ('tom',21);
upsert into student values ('jack',21);
upsert into student values('lily',25)
select * from student;

-- 建表
drop table gmall_user_status;
create table gmall_user_status( user_id varchar primary key ,state.if_consumed varchar ) SALT_BUCKETS = 3;
select * from gmall_user_status;

delete from gmall_user_status where user_id > '20000';

delete from gmall_user_status where user_id is not null;
delete from gmall_user_status where user_id > '3333';

select * from gmall_user_status;

select * from gmall_user_status where user_id in ('17953','22263','55279','70008','20441','42160','46454','38292','37908','59165','49373','321','72426','7312','62884','38239','27149','3601','59638','66134','69041','16349','27125','46309','49774','36857','65374','28265','33677','24686','18005','59261','50211','68929','49562','25591','26900','3880','26418','77982','31665','52762','62681','27038','79498','75889','31165','7966','5580','79678','12183','58631','65963','51919','27698','43887','1630','20099','18485','73741','51492','20571','71382','4956','19714','58601','4455','11781','36621','59897','12527','45672','57511','61734','32526','3079','68734','10193','20220','15397','74197','5189','75269','35129','4892','20647','10677','58477','21662','3999','56832','61014','38778','20379','37110','37087','15270','14526','48760','571','47297','36729','39134','52766','77541','30724','67540','23657','46248','9238','71685','56763','38370','37796','35333','78453','15636','32353','54465','76574','39287','51417','67769','4696','40040','31114','58981','14181','54940','31893','22708','21334','23170','63957','17953','22263','55279','70008','20441','42160','46454','38292','37908','59165','49373','321','72426','7312','62884','38239','27149','3601','59638','66134','69041','16349','27125','46309','49774','36857','65374','28265','33677','24686','18005','59261','50211','68929','49562','25591','26900','3880','26418','77982','31665','52762','62681','27038','79498','75889','31165','7966','5580','79678','12183','58631','65963','51919','27698','43887','1630','20099','18485','73741','51492','20571','71382','4956','19714','58601','4455','11781','36621','59897','12527','45672','57511','61734','32526','3079','68734','10193','20220','15397','74197','5189','75269','35129','4892','20647','10677','58477','21662','3999','56832','61014','38778','20379','37110','37087','15270','14526','48760','571','47297','36729','39134','52766','77541','30724','67540','23657','46248','9238','71685','56763','38370','37796','35333','78453','15636','32353','54465','76574','39287','51417','67769','4696','40040','31114','58981','14181','54940','31893','22708','21334','23170','63957','55279','70008','20441','42160','38292','37908','59165','72426','7312','38239','27149','66134','27125','49774','36857','65374','28265','33677','24686','18005','59261','50211','25591','26418','77982','31665','52762','62681','79498','75889','7966','5580','79678','12183','58631','65963','51919','27698','20099','18485','73741','51492','20571','71382','58601','4455','59897','12527','45672','57511','61734','68734','10193','20220','15397','35129','4892','58477','21662','3999','56832','61014','38778','37110','15270','14526','48760','571','47297','36729','39134','30724','67540','23657','56763','35333','78453','54465','76574','39287','51417','67769','40040','31114','14181','54940','22708','23170','48395','67840','45898','34100','53673','5586','40004','73347','2723','28986','27269','26400','44111','6012','5827','38205','66849','14946','68519','55085','2175','23685','76337','47225','36065','78203','72841','64193','10182','44614','9145','41577','26066','1140','58131','34156','69841','24020','67662','23365','70117','75351','55390','80068','68350','67777','39847','20068','4873','12881','5917','14205','67977','817','18043','7794','65315','79973','22461','3255','73373','53012','48630','40083','2941','47691','36438','48395','67840','45898','34100','53673','5586','40004','73347','2723','28986','27269','26400','44111','6012','5827','38205','66849','14946','68519','55085','2175','23685','76337','47225','36065','78203','72841','64193','10182','44614','9145','41577','26066','1140','58131','34156','69841','24020','67662','23365','70117','75351','55390','80068','68350','67777','39847','20068','4873','12881','5917','14205','67977','817','18043','7794','65315','79973','22461','3255','73373','53012','48630','40083','2941','47691','36438','48395','67840','53673','40004','27269','44111','6012','5827','14946','68519','55085','2175','23685','36065','78203','72841','44614','9145','41577','26066','1140','58131','24020','55390','80068','67777','39847','20068','12881','5917','14205','7794','22461','73373','53012','48630','40083','2941','47691','36438','66720','40114','6080','59560','22589','66249','71580','42933','22245','13973','36221','55721','75143','75278','53344','64665','67281','6260','55192','52270','29294','76388','77487','26258','46327','55176','73268','16862','18082','61779','15286','13478','31576','32618','35396','16748','67891','42155','73227','77797','22259','54868','80553','74934','13569','28601','60099','47489','60911','48215','35397','4611','36130','18604','34432','70455','78626','64108','67791','78262','1822','42441','56974','787','74656','46105','68801','66720','40114','6080','59560','22589','66249','71580','42933','22245','13973','36221','55721','75143','75278','53344','64665','67281','6260','55192','52270','29294','76388','77487','26258','46327','55176','73268','16862','18082','61779','15286','13478','31576','32618','35396','16748','67891','42155','73227','77797','22259','54868','80553','74934','13569','28601','60099','47489','60911','48215','35397','4611','36130','18604','34432','70455','78626','64108','67791','78262','1822','42441','56974','787','74656','46105','68801','66720','40114','6080','59560','22589','66249','71580','42933','13973','36221','75278','53344','64665','67281','6260','55192','52270','29294','76388','77487','26258','55176','73268','18082','13478','31576','32618','35396','67891','42155','73227','77797','22259','74934','13569','28601','60099','60911','48215','4611','18604','34432','78626','64108','67791','78262','1822','74656','59411','22369','22400','21479','59152','80376','29923','25552','17065','13019','47618','65434','61046','45342','40413','21321','1414','49140','21606','57098','43751','18022','47703','60019','37192','28529','75771','28792','50661','68123','3644','23905','61280','71832','11221','36353','4235','33536','43465','27099','64399','34507','18974','70381','19120','4211','23760','73430','67678','45171','49825','3371','74742','31939','69320','62267','57529','73436','863','59249','69834','4353','69516','8451','20270','13175','8106','59411','22369','22400','21479','59152','80376','29923','25552','17065','13019','47618','65434','61046','45342','40413','21321','1414','49140','21606','57098','43751','18022','47703','60019','37192','28529','75771','28792','50661','68123','3644','23905','61280','71832','11221','36353','4235','33536','43465','27099','64399','34507','18974','70381','19120','4211','23760','73430','67678','45171','49825','3371','74742','31939','69320','62267','57529','73436','863','59249','69834','4353','69516','8451','20270','13175','8106','59411','22369','22400','59152','29923','25552','17065','13019','47618','65434','61046','45342','21321','49140','43751','18022','47703','60019','28529','75771','28792','23905','71832','11221','36353','4235','33536','43465','27099','64399','34507','70381','19120','4211','23760','67678','45171','3371','74742','31939','69320','62267','57529','863','69834','69516','8451','20270','13175','8106','13977','51244','73715','21798','6831','9854','42298','54867','57661','42643','51565','3161','43017','13815','78684','39570','49443','40270','57073','52300','69767','78006','61433','69973','51987','46981','65142','8915','71179','6074','65954','6042','80452','33217','23081','61788','72614','58971','23278','75865','45134','37676','42987','74432','17833','19103','16675','34690','54653','20479','32035','48830','74097','32567','14229','32040','49019','80551','62232','32611','31763','48075','80158','80917','34163','52482','13977','51244','73715','21798','6831','9854','42298','54867','57661','42643','51565','3161','43017','13815','78684','39570','49443','40270','57073','52300','69767','78006','61433','69973','51987','46981','65142','8915','71179','6074','65954','6042','80452','33217','23081','61788','72614','58971','23278','75865','45134','37676','42987','74432','17833','19103','16675','34690','54653','20479','32035','48830','74097','32567','14229','32040','49019','80551','62232','32611','31763','48075','80158','80917','34163','52482','13977','51244','73715','6831','42298','54867','57661','42643','51565','3161','43017','78684','39570','40270','57073','52300','69767','78006','61433','69973','51987','65142','8915','71179','6074','80452','33217','23081','61788','72614','58971','75865','45134','42987','74432','17833','19103','16675','34690','54653','20479','32035','48830','74097','32040','49019','62232','32611','31763','48075','80158','80917','52482','27552','38026','60980','77966','12043','45866','8217','5228','60331','39243','80831','741','57365','60248','27917','77613','70335','66187','42422','79085','7033','67378','66795','66702','57267','4473','66094','15562','1343','63058','74854','54741','60040','3014','34357','42798','49858','12225','36066','79060','47176','56911','46230','64760','50667','14509','66399','55945','49758','5200','16414','41776','65185','67284','41620','2875','53272','11960','69491','17949','5317','9079','29551','79205','27552','38026','60980','77966','12043','45866','8217','5228','60331','39243','80831','741','57365','60248','27917','77613','70335','66187','42422','79085','7033','67378','66795','66702','57267','4473','66094','15562','1343','63058','74854','54741','60040','3014','34357','42798','49858','12225','36066','79060','47176','56911','46230','64760','50667','14509','66399','55945','49758','5200','16414','41776','65185','67284','41620','2875','53272','11960','69491','17949','5317','9079','29551','79205','27552','38026','60980','77966','12043','8217','60331','39243','80831','741','27917','77613','66187','42422','67378','66795','66702','57267','66094','15562','1343','74854','54741','60040','3014','42798','49858','12225','36066','79060','47176','46230','64760','14509','66399','49758','5200','16414','65185','67284','41620','53272','11960','69491','17949','5317','29551','79205','76434','6820','57983','71981','60118','24520','29251','45633','5388','64926','42155','45923','82030','54973','66591','75395','4512','81759','65416','9239','14224','81975','29358','47109','40146','11709','20474','10912','2909','52005','68924','68682','4365','23370','54455','63394','50167','39643','70032','65587','14240','20001','6678','10623','42450','78250','26014','31820','26458','42511','22011','5037','13583','9886','72453','46477','19126','53093','71953','70945','8423','32899','52915','58061','44625','76434','6820','57983','71981','60118','24520','29251','45633','5388','64926','42155','45923','82030','54973','66591','75395','4512','81759','65416','9239','14224','81975','29358','47109','40146','11709','20474','10912','2909','52005','68924','68682','4365','23370','54455','63394','50167','39643','70032','65587','14240','20001','6678','10623','42450','78250','26014','31820','26458','42511','22011','5037','13583','9886','72453','46477','19126','53093','71953','70945','8423','32899','52915','58061','44625','6820','57983','71981','29251','5388','64926','42155','82030','54973','75395','4512','81759','65416','14224','81975','47109','40146','20474','10912','52005','68924','68682','4365','23370','54455','63394','50167','39643','70032','14240','20001','6678','10623','26014','31820','26458','22011','5037','13583','9886','72453','46477','53093','71953','70945','8423','32899','37758','5830','22339','16138','65738','63909','26384','14958','64562','16662','66540','19151','75017','36354','7951','59084','40440','77105','8569','1841','59501','66292','30010','34350','72540','19130','40846','13966','28484','37984','68195','36752','61863','39807','26070','32675','63303','17252','77776','22595','50304','28370','43501','10119','56483','47762','30188','80704','53072','77376','82060','79842','70801','2880','57874','43370','11615','41256','76741','78530','29656','37635','5503','58035','37758','5830','22339','16138','65738','63909','26384','14958','64562','16662','66540','19151','75017','36354','7951','59084','40440','77105','8569','1841','59501','66292','30010','34350','72540','19130','40846','13966','28484','37984','68195','36752','61863','39807','26070','32675','63303','17252','77776','22595','50304','28370','43501','10119','56483','47762','30188','80704','53072','77376','82060','79842','70801','2880','57874','43370','11615','41256','76741','78530','29656','37635','5503','58035','37758','22339','65738','63909','16662','19151','75017','36354','7951','77105','8569','1841','66292','30010','72540','19130','40846','13966','28484','37984','68195','36752','61863','39807','26070','63303','77776','22595','50304','56483','47762','53072','77376','82060','79842','2880','57874','76741','78530','37635','5503','14946','62158','73618','62740','75330','46743','18995','70447','26942','77753','57751','35428','44740','11843','18551','7997','56053','54465','4902','53075','47869','39002','8369','66061','30398','69567','44688','25839','75496','79584','69242','23557','47686','11043','9664','16635','11595','64333','64807','56767','2408','66619','51313','50342','56472','65441','29486','2614','53386','16291','44010','69557','79563','19362','32907','22323','60665','14974','11259','21015','35812','31951','27219','72571','57003','11451','19608','26653','38337','67827','26416','64487','14946','62158','73618','62740','75330','46743','18995','70447','26942','77753','57751','35428','44740','11843','18551','7997','56053','54465','4902','53075','47869','39002','8369','66061','30398','69567','44688','25839','75496','79584','69242','23557','47686','11043','9664','16635','11595','64333','64807','56767','2408','66619','51313','50342','56472','65441','29486','2614','53386','16291','44010','69557','79563','19362','32907','22323','60665','14974','11259','21015','35812','31951','27219','72571','57003','11451','19608','26653','38337','67827','26416','64487','62740','75330','46743','70447','77753','11843','7997','56053','54465','4902','53075','47869','8369','66061','30398','69567','44688','79584','23557','47686','11043','9664','16635','64333','64807','56767','2408','66619','51313','56472','65441','29486','53386','16291','79563','19362','32907','22323','14974','35812','27219','11451','19608','38337','67827','26416','64487','71754','31437','64898','51674','80521','78164','14026','31450','49015','44629','22888','42437','58729','48321','4375','28416','34389','55376','16752','8423','79412','71427','5397','45682','9849','53137','13829','82517','49717','6543','55753','10334','29496','56514','46390','31090','56141','62570','63735','50545','77984','9475','62844','38347','5318','46924','52714','36822','54994','5898','18367','39861','42979','72142','29306','16162','69274','23878','60582','49316','15034','48158','50451','53290','53553','28006','11755','30209','6882','52680','38748','64017','71754','31437','64898','51674','80521','78164','14026','31450','49015','44629','22888','42437','58729','48321','4375','28416','34389','55376','16752','8423','79412','71427','5397','45682','9849','53137','13829','82517','49717','6543','55753','10334','29496','56514','46390','31090','56141','62570','63735','50545','77984','9475','62844','38347','5318','46924','52714','36822','54994','5898','18367','39861','42979','72142','29306','16162','69274','23878','60582','49316','15034','48158','50451','53290','53553','28006','11755','30209','6882','52680','38748','64017','71754','31437','51674','80521','78164','14026','31450','44629','22888','42437','58729','48321','4375','28416','55376','16752','8423','79412','71427','9849','53137','13829','82517','49717','55753','10334','29496','56514','56141','62570','63735','50545','77984','9475','62844','38347','5318','52714','5898','18367','39861','42979','29306','69274','23878','60582','15034','48158','53290','53553','28006','30209','6882','38748','64017','62964','39588','17754','62056','77201','19800','47767','19765','66058','28213','73571','68255','28413','62724','56048','31859','21697','81375','42713','3619','36876','79072','12174','40566','70930','24998','65259','13180','55076','12186','47101','4743','16611','44012','47605','75606','43699','58354','72683','21771','65914','3386','7930','77402','38494','11716','51658','51905','38627','207','37729','14365','63596','31786','80069','37878','26282','21898','16223','66762','57366','70584','76664','45263','43270','76410','27483','24438','39567','78399','29','43119','62964','39588','17754','62056','77201','19800','47767','19765','66058','28213','73571','68255','28413','62724','56048','31859','21697','81375','42713','3619','36876','79072','12174','40566','70930','24998','65259','13180','55076','12186','47101','4743','16611','44012','47605','75606','43699','58354','72683','21771','65914','3386','7930','77402','38494','11716','51658','51905','38627','207','37729','14365','63596','31786','80069','37878','26282','21898','16223','66762','57366','70584','76664','45263','43270','76410','27483','24438','39567','78399','29','43119','62964','39588','17754','62056','19800','47767','28213','73571','28413','56048','31859','21697','79072','12174','13180','55076','12186','47101','4743','16611','44012','47605','43699','58354','21771','65914','77402','11716','51658','51905','37729','31786','80069','37878','26282','21898','16223','66762','70584','76664','45263','43270','76410','39567','78399','43119')

-- 创建维度表
create table gmall_province_info (id varchar primary key,info.name varchar,info.area_code varchar,info.iso_code varchar) SALT_BUCKETS = 3;
select * from gmall_province_info;
select * from gmall_province_info where id='1';
select id,count(1) from gmall_province_info group by id;


delete from gmall_user_info where id is not null;
create table gmall_user_info (id varchar primary key ,user_level varchar,  birthday varchar,gender varchar, age_group varchar , gender_name varchar)SALT_BUCKETS = 3;
select * from gmall_user_info;
select * from gmall_user_info where id='1';
select id,count(1) from gmall_user_info group by id;
select ID,USER_LEVEL,BIRTHDAY,GENDER,AGE_GROUP,GENDER_NAME from gmall_user_info where id in ('58621');

select count(1) from gmall_user_info;

delete from gmall_user_info;


-- 品牌维度表
create table gmall_base_trademark (id varchar primary key ,tm_name varchar);
select * from gmall_base_trademark;
select count(1) from gmall_base_trademark;
select id,count(1) from gmall_base_trademark group by id;

-- 品类维度表
create table gmall_base_category3 (id varchar primary key ,name varchar ,category2_id varchar);
select * from gmall_base_category3;
select count(1) from gmall_base_category3;
select id,count(1) from gmall_base_category3 group by id;

-- spu 商品聚集查询维度表
create table gmall_spu_info (id varchar primary key ,spu_name varchar);
select * from gmall_spu_info;
select count(1) from gmall_spu_info;
select id,count(1) from gmall_spu_info group by id;

-- sku 维度退化表（已经关联好了 品牌、品类、spu信息）
drop table gmall_sku_expand_info;
create table gmall_sku_info_expand (id varchar primary key ,  spu_id  varchar, price  varchar, sku_name varchar, tm_id varchar, category3_id varchar, create_time varchar, category3_name varchar, spu_name varchar, tm_name varchar ) SALT_BUCKETS = 3;
select * from gmall_sku_info_expand;
select id,count(1) from gmall_sku_info_expand group by id;

select * from gmall_sku_info_expand where id in ('2');


