package com.example.log.test

import com.example.log.util.MyPhoenixUtil
import org.junit.Test

class MyPhoenixTest {

  @Test
  def queryTest(): Unit ={
    val list = MyPhoenixUtil.queryList("select * from student")
    list.foreach(println(_))
  }

  @Test
  def queryTest2(): Unit ={
    val sql = "select user_id,if_consumed from user_status where user_id in ('39568','4494','35072','22386','13826','41518','30617','10851','22137','24257','38660','20139','40423','37434','38448','39238','20957','26921','23742','41989','40927','38994','30445','21803','40366','5957','4632','40835','11375','40169','17564','9304','2804','11027','18422','37786','4046','17068','1404','18171','25810','2060','19769','26767','27564','41854','27356','11901','1764','38821','33836','5764','5040','13966','29115','3157','24037','20035','26348','3841','3854','35013','27893','35846','23027','7197','17333','3536','33124','4468','21918','24817','2958','7113','19977','18866','29884','14967','326','23959','34379','3977','14049','3835','6004','6300','40634','11599','8445','24863','11914','484','36956','15397','11367','3523','29388','28604','30751','2444','3165','32294','5043','13109','7829','9358','40294','32858','38080','33116','14952','11688','16312','26365','8197','41377','14100','41076','4223','13622','11890','11042','19400','24420','11034','33819','34998','21685','41568','40127','25075','28403','33423','7137','3263','3896','41356','6365','17538','25857','6466','24533','40439','20974','21925','2232','28831','9654','5075','3570','18680','17811','13824','33247','10096','19199','20548','26618','33029','35199','26933','20783','31304','14639','5707','3323','2641','7568','1899','26720','4998','25769','12528','25643','17473','11875','5868','16279','14855','31727','32735','7853','32109','10977','9668','40913','18792','38834','40360','14019','13145','28698')"
    val list = MyPhoenixUtil.queryList(sql)
    list.foreach(println(_))
    val consumedUsers = list.map(_.getString("USER_ID"))
    println(consumedUsers.size)
  }



}
